import{j as e}from"./vendor-motion-DD2yjgze.js";import{r as d}from"./vendor-react-Chdf233T.js";import{u as v,b as N,A as o,t as w,B as C,C as D,l as S,D as E,E as L}from"./index-Cwht9-s6.js";import{P as F}from"./PageHeader-dyIY6vfZ.js";import"./vendor-utils-BpAiQRgT.js";import"./vendor-icons-DwoABqcb.js";function U(){const{user:l}=v(),{t:r}=N(),[m,u]=d.useState([]),[g,y]=d.useState(!0),[h,n]=d.useState(!1),[a,s]=d.useState({tier:"FREE",duration:"30days",customDate:"",maxServers:1});d.useEffect(()=>{c()},[]);const c=async()=>{try{const t=await o.getAll();u(t.data.data)}catch{}finally{y(!1)}},b=()=>{const{duration:t,customDate:i}=a;if(t==="lifetime")return null;if(t==="custom")return i||null;const x=new Date,p={"30days":30,"90days":90,"1year":365}[t];return p?(x.setDate(x.getDate()+p),x.toISOString().split("T")[0]):null},k=async t=>{t.preventDefault();try{const i=b();await o.create({tier:a.tier,expiresAt:i,maxServers:parseInt(a.maxServers)}),n(!1),s({tier:"FREE",duration:"30days",customDate:"",maxServers:1}),c()}catch{alert("Failed to create license")}},j=async t=>{if(confirm(r("pages.adminLicenses.deleteConfirm")))try{await o.delete(t),c()}catch{alert("Failed to delete license")}},f=t=>{navigator.clipboard.writeText(t),alert(r("pages.adminLicenses.keyCopied"))};return g?e.jsx("div",{className:"text-center py-8",children:r("pages.adminLicenses.loading")}):(l==null?void 0:l.role)!=="ADMIN"?e.jsx("div",{className:"text-center py-12 text-gray-500",children:r("pages.adminLicenses.accessDenied")}):e.jsxs("div",{children:[e.jsx(F,{title:r("pages.adminLicenses.title"),icon:w,iconColor:"text-yellow-500",actions:e.jsxs("button",{onClick:()=>n(!0),className:"btn-primary flex items-center gap-2",children:[e.jsx(C,{}),e.jsx("span",{children:r("pages.adminLicenses.createLicense")})]})}),h&&e.jsxs("div",{className:"card p-6 mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-900 dark:text-white",children:"Create New License"}),e.jsxs("form",{onSubmit:k,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 dark:text-gray-300 mb-2",children:"Tier"}),e.jsxs("select",{value:a.tier,onChange:t=>s({...a,tier:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-dark-600 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white dark:bg-dark-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"FREE",children:"Free"}),e.jsx("option",{value:"PREMIUM",children:"Premium"}),e.jsx("option",{value:"VIP",children:"VIP"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 dark:text-gray-300 mb-2",children:"Max Uses (Servers)"}),e.jsx("input",{type:"number",min:"1",value:a.maxServers,onChange:t=>s({...a,maxServers:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-dark-600 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white dark:bg-dark-700 text-gray-900 dark:text-white"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 dark:text-gray-300 mb-2",children:"Duration"}),e.jsxs("select",{value:a.duration,onChange:t=>s({...a,duration:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-dark-600 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white dark:bg-dark-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"30days",children:"30 Days"}),e.jsx("option",{value:"90days",children:"90 Days"}),e.jsx("option",{value:"1year",children:"1 Year"}),e.jsx("option",{value:"lifetime",children:"Lifetime (No Expiration)"}),e.jsx("option",{value:"custom",children:"Custom Date"})]})]}),a.duration==="custom"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 dark:text-gray-300 mb-2",children:"Custom Expiration Date"}),e.jsx("input",{type:"date",value:a.customDate,onChange:t=>s({...a,customDate:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-dark-600 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white dark:bg-dark-700 text-gray-900 dark:text-white",required:!0})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{type:"submit",className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg",children:"Create"}),e.jsx("button",{type:"button",onClick:()=>n(!1),className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg",children:"Cancel"})]})]})]}),e.jsx("div",{className:"card overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-dark-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-dark-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"License Key"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Tier"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Max Servers"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Active"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Expires"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white dark:bg-dark-800 divide-y divide-gray-200 dark:divide-dark-700",children:m.map(t=>e.jsxs("tr",{children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-mono flex items-center gap-2 text-gray-900 dark:text-gray-100",children:[t.licenseKey,e.jsx("button",{onClick:()=>f(t.licenseKey),className:"text-gray-400 hover:text-blue-500 dark:hover:text-blue-400",children:e.jsx(D,{})})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${t.tier==="VIP"?"bg-purple-100 dark:bg-purple-900/30 text-purple-800 dark:text-purple-300":t.tier==="PREMIUM"?"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300":"bg-gray-100 dark:bg-dark-600 text-gray-800 dark:text-gray-300"}`,children:t.tier})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:t.maxServers===-1?"Unlimited":t.maxServers}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:t.isActive?e.jsx(S,{className:"text-green-600 dark:text-green-400"}):e.jsx(E,{className:"text-red-600 dark:text-red-400"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:t.expiresAt?new Date(t.expiresAt).toLocaleDateString():"Never"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right",children:e.jsx("button",{onClick:()=>j(t.id),className:"text-red-600 hover:text-red-800 p-2",title:"Delete License",children:e.jsx(L,{})})})]},t.id))})]})})]})}export{U as default};
