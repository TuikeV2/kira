import{j as e}from"./vendor-motion-DD2yjgze.js";import{e as S,r as o,L as i}from"./vendor-react-Chdf233T.js";import{u as L,b as A,o as E,p as $,q as u,r as D,s as F,t as v,v as C,w as M,x as T,y,z as R}from"./index-Cwht9-s6.js";import{S as m}from"./StatCard-BNGy35B2.js";import{S as z}from"./Skeleton-CfjySvX3.js";import"./vendor-utils-BpAiQRgT.js";import"./vendor-icons-DwoABqcb.js";function H(){var b;const{user:t}=L(),{t:a}=A(),p=S(),[h,j]=o.useState([]),[g,f]=o.useState([]),[x,N]=o.useState(!0);o.useEffect(()=>{if((t==null?void 0:t.role)==="ADMIN"){p("/admin/dashboard",{replace:!0});return}w()},[t,p]);const w=async()=>{try{const[s,r]=await Promise.all([E.getUserGuilds().catch(()=>({data:{data:[]}})),$.getPurchaseHistory().catch(()=>({data:{data:[]}}))]);j(s.data.data||[]),f(r.data.data||[])}catch{}finally{N(!1)}};if((t==null?void 0:t.role)==="ADMIN")return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"w-10 h-10 border-4 border-primary-500 border-t-transparent rounded-full animate-spin"})});const n=g.filter(s=>s.isActive),c=n.find(s=>{if(!s.expiresAt)return!1;const r=Math.ceil((new Date(s.expiresAt)-new Date)/(1e3*60*60*24));return r<=7&&r>0}),l=c?Math.ceil((new Date(c.expiresAt)-new Date)/(1e3*60*60*24)):null,d=h.filter(s=>s.registered&&s.isActive&&s.license),k=[{label:a("nav.servers")||"My Servers",icon:u,path:"/servers",color:"bg-blue-500"},{label:a("nav.activateLicense")||"Activate License",icon:D,path:"/activate",color:"bg-green-500"},{label:a("nav.buyLicense")||"Buy License",icon:F,path:"/buy",color:"bg-purple-500"},{label:a("nav.licenses")||"My Licenses",icon:v,path:"/my-licenses",color:"bg-amber-500"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{src:t!=null&&t.avatar?`https://cdn.discordapp.com/avatars/${t.discordId}/${t.avatar}.png?size=128`:"https://cdn.discordapp.com/embed/avatars/0.png",alt:t==null?void 0:t.username,className:"w-14 h-14 rounded-2xl border-2 border-white dark:border-dark-700 shadow-lg"}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[a("pages.dashboard.welcome")||"Welcome",", ",t==null?void 0:t.username,"!"]}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:a("pages.dashboard.welcomeSubtitle")||"Here is an overview of your KiraEvo panel"})]})]}),c&&e.jsx("div",{className:"card border-amber-300 dark:border-amber-700 bg-amber-50 dark:bg-amber-900/20 p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(C,{className:"text-amber-500 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-amber-800 dark:text-amber-200",children:a("pages.dashboard.licenseExpiring")||"Your license expires soon!"}),e.jsxs("p",{className:"text-sm text-amber-700 dark:text-amber-300",children:[l," ",l===1?a("pages.myLicenses.day")||"day":a("pages.myLicenses.days")||"days"," ",a("pages.dashboard.remaining")||"remaining"]})]}),e.jsx(i,{to:"/buy",className:"btn-primary btn-sm flex-shrink-0",children:a("pages.myLicenses.extendNow")||"Extend now"})]})}),x?e.jsx(z,{}):e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(m,{title:a("pages.dashboard.yourServers")||"Your Servers",value:d.length,icon:u,color:"blue",subtitle:`${h.length} ${a("pages.dashboard.total")||"total"}`}),e.jsx(m,{title:a("pages.dashboard.activeLicenses")||"Active Licenses",value:n.length,icon:v,color:"green",subtitle:`${g.length} ${a("pages.dashboard.purchased")||"purchased"}`}),e.jsx(m,{title:a("pages.dashboard.daysToExpire")||"Days to Expire",value:l??"âˆž",icon:M,color:l&&l<=7?"red":"yellow",subtitle:c?c.tier:a("pages.dashboard.noExpiry")||"No expiring license"}),e.jsx(m,{title:a("pages.dashboard.currentTier")||"Current Tier",value:((b=n[0])==null?void 0:b.tier)||"-",icon:T,color:"purple",subtitle:n.length>0?a("pages.account.activeLicense")||"Active":a("pages.dashboard.noLicense")||"No license"})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:a("pages.dashboard.quickActions")||"Quick Actions"}),e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:k.map(s=>e.jsxs(i,{to:s.path,className:"card p-4 flex flex-col items-center gap-3 text-center hover:shadow-soft-lg dark:hover:shadow-dark-lg transition-all group",children:[e.jsx("div",{className:`${s.color} p-3 rounded-xl text-white group-hover:scale-110 transition-transform`,children:e.jsx(s.icon,{className:"w-5 h-5"})}),e.jsx("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:s.label})]},s.path))})]}),!x&&d.length>0&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:a("pages.dashboard.recentServers")||"Your Servers"}),e.jsxs(i,{to:"/servers",className:"text-sm text-primary-500 hover:text-primary-600 flex items-center gap-1",children:[a("pages.dashboard.viewAll")||"View all"," ",e.jsx(y,{className:"w-3 h-3"})]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:d.slice(0,4).map(s=>{var r;return e.jsxs(i,{to:`/servers/${s.id}`,className:"card p-4 flex items-center gap-4 hover:shadow-soft-lg dark:hover:shadow-dark-lg transition-all group",children:[e.jsx("img",{src:s.icon?`https://cdn.discordapp.com/icons/${s.id}/${s.icon}.png?size=64`:"https://cdn.discordapp.com/embed/avatars/0.png",alt:s.name,className:"w-12 h-12 rounded-xl shadow-sm",loading:"lazy"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white truncate",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[((r=s.memberCount)==null?void 0:r.toLocaleString())||"?"," ",a("common.members").toLowerCase()]})]}),s.license&&e.jsx("span",{className:`px-2 py-1 rounded-lg text-xs font-semibold ${s.license.tier==="VIP"?"bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300":"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300"}`,children:s.license.tier}),e.jsx(y,{className:"w-4 h-4 text-gray-300 dark:text-gray-600 group-hover:text-primary-500 transition-colors"})]},s.id)})})]}),!x&&d.length===0&&e.jsxs("div",{className:"card p-8 text-center",children:[e.jsx(R,{className:"w-12 h-12 text-primary-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:a("pages.dashboard.getStarted")||"Get Started with KiraEvo"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-6 max-w-md mx-auto",children:a("pages.dashboard.getStartedDesc")||"Add the bot to your server and activate a license to unlock all features"}),e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx(i,{to:"/buy",className:"btn-gradient",children:a("nav.buyLicense")||"Buy License"}),e.jsx(i,{to:"/servers",className:"btn-secondary",children:a("nav.servers")||"My Servers"})]})]})]})}export{H as default};
