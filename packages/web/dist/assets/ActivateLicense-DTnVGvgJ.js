import{j as e}from"./vendor-motion-DD2yjgze.js";import{e as A,r as n}from"./vendor-react-Chdf233T.js";import{b as C,G as E,o as R,t as k,ad as T,z as $,q as d,R as v,Q as D,g as G,l as B,x as w,A as P}from"./index-Cwht9-s6.js";import"./vendor-utils-BpAiQRgT.js";import"./vendor-icons-DwoABqcb.js";function O(){var f;const X=A(),{t:a}=C(),l=E(),[x,L]=n.useState([]),[S,F]=n.useState(!0),[h,u]=n.useState(!1),[r,o]=n.useState({licenseKey:"",guildId:""}),[i,m]=n.useState(null),[g,j]=n.useState(null);n.useEffect(()=>{y()},[]);const y=async()=>{try{const s=await R.getUserGuilds();L(s.data.data||[])}catch{l.error(a("errors.networkError"))}finally{F(!1)}},I=s=>{o({...r,guildId:s});const t=x.find(c=>c.id===s);j(t)},z=async s=>{var t,c;if(s.preventDefault(),!r.licenseKey.trim()){l.error(a("errors.invalidInput"));return}if(!r.guildId){l.error(a("errors.invalidInput"));return}u(!0),m(null);try{const b=await P.activate({licenseKey:r.licenseKey.trim(),guildId:r.guildId,guildName:g==null?void 0:g.name});m({success:!0,message:a("pages.activateLicense.activated"),data:b.data.data}),l.success(a("pages.activateLicense.activatedSuccess")),o({licenseKey:"",guildId:""}),j(null),setTimeout(()=>y(),1500)}catch(b){const N=((c=(t=b.response)==null?void 0:t.data)==null?void 0:c.message)||"Nie udalo sie aktywowac licencji";m({success:!1,message:N}),l.error(N)}finally{u(!1)}},K=s=>{if(!s)return"Nigdy";const t=new Date(s);return isNaN(t.getTime())?"Nigdy":t.toLocaleDateString("pl-PL")},p=x.filter(s=>s.registered);return p.filter(s=>!s.license||s.license.tier==="FREE"),S?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"w-8 h-8 border-4 border-primary-500 border-t-transparent rounded-full animate-spin"})}):e.jsxs("div",{className:"space-y-6 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-gradient-to-br from-green-400 to-green-600 shadow-lg mb-4",children:e.jsx(k,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:a("pages.activateLicense.title")}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-2",children:a("pages.activateLicense.subtitle")})]}),e.jsx("div",{className:"card p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(T,{className:"w-5 h-5 text-blue-500 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-blue-700 dark:text-blue-300",children:[e.jsx("p",{className:"font-medium mb-1",children:a("pages.activateLicense.howTo")}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1",children:[e.jsxs("li",{children:[a("pages.activateLicense.step1")," ",e.jsx("code",{className:"bg-blue-100 dark:bg-blue-800 px-1 rounded",children:"KIRA-XXXX-XXXX-XXXX"})]}),e.jsx("li",{children:a("pages.activateLicense.step2")}),e.jsx("li",{children:a("pages.activateLicense.step3")})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card p-6",children:[e.jsxs("h2",{className:"text-lg font-bold text-gray-900 dark:text-white mb-6 flex items-center gap-2",children:[e.jsx($,{className:"text-primary-500"}),a("pages.activateLicense.formTitle")]}),e.jsxs("form",{onSubmit:z,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 flex items-center gap-2",children:[e.jsx(k,{className:"text-amber-500"}),a("pages.activateLicense.licenseKey")]}),e.jsx("input",{type:"text",value:r.licenseKey,onChange:s=>o({...r,licenseKey:s.target.value.toUpperCase()}),placeholder:"KIRA-XXXX-XXXX-XXXX",className:"input font-mono text-center text-lg tracking-wider",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 flex items-center gap-2",children:[e.jsx(d,{className:"text-primary-500"}),"Wybierz Serwer"]}),p.length===0?e.jsx("div",{className:"p-4 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-xl",children:e.jsx("p",{className:"text-sm text-amber-700 dark:text-amber-300",children:"Bot nie jest na zadnym z Twoich serwerow. Dodaj bota na serwer, aby moc aktywowac licencje."})}):e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:p.map(s=>{const t=r.guildId===s.id,c=s.license&&s.license.tier!=="FREE";return e.jsxs("div",{onClick:()=>I(s.id),className:`
                          flex items-center gap-3 p-3 rounded-xl cursor-pointer transition-all
                          ${t?"bg-primary-50 dark:bg-primary-900/20 border-2 border-primary-500":"bg-gray-50 dark:bg-dark-700 border-2 border-transparent hover:border-gray-200 dark:hover:border-dark-600"}
                        `,children:[s.icon?e.jsx("img",{src:`https://cdn.discordapp.com/icons/${s.id}/${s.icon}.png`,alt:s.name,className:"w-10 h-10 rounded-lg"}):e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gray-200 dark:bg-dark-600 flex items-center justify-center",children:e.jsx(d,{className:"text-gray-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white truncate",children:s.name}),c&&e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Obecna licencja: ",s.license.tier]})]}),t&&e.jsx(v,{className:"w-5 h-5 text-primary-500 flex-shrink-0"}),c&&e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s.license.tier==="VIP"?"bg-purple-100 dark:bg-purple-900/30 text-purple-600 dark:text-purple-400":"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400"}`,children:s.license.tier})]},s.id)})})]}),i&&e.jsxs("div",{className:`p-4 rounded-xl ${i.success?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[i.success?e.jsx(v,{className:"w-5 h-5 text-green-500"}):e.jsx(D,{className:"w-5 h-5 text-red-500"}),e.jsx("span",{className:`font-medium ${i.success?"text-green-700 dark:text-green-300":"text-red-700 dark:text-red-300"}`,children:i.message})]}),i.success&&((f=i.data)==null?void 0:f.license)&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-green-200 dark:border-green-800",children:[e.jsxs("p",{className:"text-sm text-green-600 dark:text-green-400",children:["Tier: ",e.jsx("span",{className:"font-medium",children:i.data.license.tier})]}),e.jsxs("p",{className:"text-sm text-green-600 dark:text-green-400",children:["Wygasa: ",e.jsx("span",{className:"font-medium",children:K(i.data.license.expiresAt)})]})]})]}),e.jsx("button",{type:"submit",disabled:h||!r.licenseKey||!r.guildId,className:`
                w-full py-4 rounded-xl font-bold text-lg
                flex items-center justify-center gap-3
                transition-all duration-300
                ${!r.licenseKey||!r.guildId?"bg-gray-300 dark:bg-dark-600 text-gray-500 dark:text-gray-400 cursor-not-allowed":"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 text-white shadow-lg hover:shadow-xl"}
              `,children:h?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Aktywowanie..."]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"w-5 h-5"}),"Aktywuj Licencje"]})})]})]}),e.jsxs("div",{className:"card p-6",children:[e.jsxs("h2",{className:"text-lg font-bold text-gray-900 dark:text-white mb-6 flex items-center gap-2",children:[e.jsx(d,{className:"text-primary-500"}),"Twoje Serwery"]}),x.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(d,{className:"w-12 h-12 text-gray-300 dark:text-gray-600 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Nie znaleziono serwerow. Upewnij sie, ze masz uprawnienia do zarzadzania serwerami."})]}):e.jsx("div",{className:"space-y-3",children:x.map(s=>{const t=s.registered&&s.license&&s.license.tier!=="FREE";return e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-dark-700 rounded-xl hover:bg-gray-100 dark:hover:bg-dark-600 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[s.icon?e.jsx("img",{src:`https://cdn.discordapp.com/icons/${s.id}/${s.icon}.png`,alt:s.name,className:"w-10 h-10 rounded-lg"}):e.jsx("div",{className:"w-10 h-10 rounded-lg bg-gray-200 dark:bg-dark-500 flex items-center justify-center",children:e.jsx(d,{className:"text-gray-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[s.owner&&e.jsx("span",{className:"text-primary-600 dark:text-primary-400",children:"Wlasciciel"}),s.registered?e.jsxs("span",{className:"text-green-600 dark:text-green-400 flex items-center gap-1",children:[e.jsx(B,{className:"w-3 h-3"})," Bot aktywny"]}):e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Bot nieaktywny"})]})]})]}),e.jsx("div",{children:t?e.jsxs("span",{className:`px-3 py-1.5 rounded-full text-xs font-semibold flex items-center gap-1 ${s.license.tier==="VIP"?"bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300":"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300"}`,children:[e.jsx(w,{className:"w-3 h-3"}),s.license.tier]}):s.registered?e.jsx("span",{className:"px-3 py-1.5 rounded-full text-xs font-medium bg-gray-100 dark:bg-dark-600 text-gray-600 dark:text-gray-400",children:"Brak licencji"}):e.jsx("span",{className:"px-3 py-1.5 rounded-full text-xs font-medium bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-300",children:"Dodaj bota"})})]},s.id)})}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-100 dark:border-dark-700",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-3",children:"Nie masz jeszcze licencji?"}),e.jsxs("button",{onClick:()=>X("/buy"),className:"w-full btn-primary flex items-center justify-center gap-2",children:[e.jsx(w,{className:"w-4 h-4"}),"Kup Licencje VIP"]})]})]})]})]})}export{O as default};
