import{j as e}from"./vendor-motion-DD2yjgze.js";import{e as G,r as n}from"./vendor-react-Chdf233T.js";import{u as V,b as X,G as Y,bo as o,j as B,g as z,I,R as _,bv as q,Q,bw as H}from"./index-Cwht9-s6.js";import{S as l}from"./StatCard-BNGy35B2.js";import{A as i}from"./AnimatedCard-CGD3nK9r.js";import{S as J,a as R}from"./Skeleton-CfjySvX3.js";import{R as m,L as Z,C as D,X as F,Y as M,T as x,a as ee,P as ae,c as se,d as te,e as re,B as ie,b as de}from"./vendor-charts-8704ybuX.js";import"./vendor-utils-BpAiQRgT.js";import"./vendor-icons-DwoABqcb.js";const y={backgroundColor:"var(--tooltip-bg, #1f2937)",border:"none",borderRadius:"8px",color:"var(--tooltip-text, #fff)"},P=["#3b82f6","#ef4444","#f59e0b","#10b981","#8b5cf6","#ec4899","#06b6d4","#84cc16"];function pe(){var j,u,f,k,b,N,v,S,w,C,A,T;const{user:$}=V(),{t:s}=X();G();const[d,L]=n.useState("commands"),[c,K]=n.useState(7),[t,h]=n.useState(null),[E,g]=n.useState(!0),W=Y(),p=n.useCallback(async()=>{g(!0);try{const a={period:c};let r;d==="commands"?r=await o.getCommandAnalytics(a):d==="automod"?r=await o.getAutomodAnalytics(a):r=await o.getModerationAnalytics(a),h(r.data.data)}catch{W.error(s("common.fetchError")||"Failed to load analytics")}finally{g(!1)}},[d,c,$]);n.useEffect(()=>{p()},[p]);const O=[{id:"commands",label:s("adminStats.commands")||"Komendy",icon:B},{id:"automod",label:s("adminStats.automod")||"AutoMod",icon:z},{id:"moderation",label:s("adminStats.moderation")||"Moderacja",icon:I}],U=[{value:7,label:s("adminStats.days7")||"7 dni"},{value:30,label:s("adminStats.days30")||"30 dni"},{value:"all",label:s("adminStats.all")||"Wszystko"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"page-title",children:s("adminStats.title")||"Statystyki bota"}),e.jsx("p",{className:"page-subtitle",children:s("adminStats.subtitle")||"Analityka komend, automod i moderacji"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsx("div",{className:"flex gap-1 bg-gray-100 dark:bg-dark-800 rounded-lg p-1",children:O.map(a=>e.jsxs("button",{onClick:()=>{L(a.id),h(null)},className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${d===a.id?"bg-white dark:bg-dark-700 text-primary-600 dark:text-primary-400 shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"}`,children:[e.jsx(a.icon,{className:"w-4 h-4"}),a.label]},a.id))}),e.jsx("div",{className:"flex gap-1 bg-gray-100 dark:bg-dark-800 rounded-lg p-1",children:U.map(a=>e.jsx("button",{onClick:()=>K(a.value),className:`px-3 py-1.5 rounded-lg text-xs font-medium transition-colors ${c===a.value?"bg-white dark:bg-dark-700 text-primary-600 dark:text-primary-400 shadow-sm":"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200"}`,children:a.label},a.value))})]}),E?e.jsxs("div",{className:"space-y-6",children:[e.jsx(J,{}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:"card p-6",children:e.jsx(R,{rows:5})}),e.jsx("div",{className:"card p-6",children:e.jsx(R,{rows:5})})]})]}):e.jsxs(e.Fragment,{children:[d==="commands"&&t&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx(l,{title:s("adminStats.totalCommands")||"Razem komend",value:t.totalCommands||0,icon:B,color:"blue"}),e.jsx(l,{title:s("adminStats.successRate")||"Wskaznik sukcesu",value:`${t.successRate||0}%`,icon:_,color:"green"}),e.jsx(l,{title:s("adminStats.uniqueCommands")||"Unikalne komendy",value:((j=t.topCommands)==null?void 0:j.length)||0,icon:q,color:"purple"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(i,{className:"card p-6",children:[e.jsx("h2",{className:"section-title mb-4",children:s("adminStats.commandsPerDay")||"Komendy / dzien"}),e.jsx("div",{className:"h-64",children:((u=t.commandsPerDay)==null?void 0:u.length)>0?e.jsx(m,{width:"100%",height:"100%",children:e.jsxs(Z,{data:t.commandsPerDay,children:[e.jsx(D,{strokeDasharray:"3 3",stroke:"#374151",opacity:.3}),e.jsx(F,{dataKey:"date",stroke:"#9ca3af",tick:{fontSize:11}}),e.jsx(M,{stroke:"#9ca3af"}),e.jsx(x,{contentStyle:y}),e.jsx(ee,{type:"monotone",dataKey:"count",stroke:"#3b82f6",strokeWidth:2,dot:{r:4},name:s("adminStats.commands")||"Komendy"})]})}):e.jsx("div",{className:"h-full flex items-center justify-center text-gray-400",children:"Brak danych"})})]}),e.jsxs(i,{className:"card p-6",children:[e.jsx("h2",{className:"section-title mb-4",children:s("adminStats.topCommands")||"Top komendy"}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:((f=t.topCommands)==null?void 0:f.length)>0?t.topCommands.map((a,r)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 dark:bg-dark-700/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-6 h-6 rounded-full bg-primary-100 dark:bg-primary-900/30 text-primary-600 dark:text-primary-400 text-xs font-bold flex items-center justify-center",children:r+1}),e.jsxs("span",{className:"text-sm font-mono text-gray-700 dark:text-gray-200",children:["/",a.name]})]}),e.jsx("span",{className:"text-sm font-semibold text-gray-600 dark:text-gray-300",children:a.count})]},a.name)):e.jsx("div",{className:"text-center py-8 text-gray-400",children:"Brak danych"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(i,{className:"card p-6",children:[e.jsx("h2",{className:"section-title mb-4",children:s("adminStats.activeServers")||"Aktywne serwery"}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:((k=t.activeServers)==null?void 0:k.length)>0?t.activeServers.map((a,r)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 dark:bg-dark-700/50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-mono text-gray-600 dark:text-gray-300",children:a.guildId}),e.jsx("span",{className:"text-sm font-semibold text-gray-600 dark:text-gray-300",children:a.count})]},a.guildId)):e.jsx("div",{className:"text-center py-4 text-gray-400",children:"Brak danych"})})]}),e.jsxs(i,{className:"card p-6",children:[e.jsx("h2",{className:"section-title mb-4",children:s("adminStats.activeUsers")||"Aktywni uzytkownicy"}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:((b=t.activeUsers)==null?void 0:b.length)>0?t.activeUsers.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 dark:bg-dark-700/50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-mono text-gray-600 dark:text-gray-300",children:a.userId}),e.jsx("span",{className:"text-sm font-semibold text-gray-600 dark:text-gray-300",children:a.count})]},a.userId)):e.jsx("div",{className:"text-center py-4 text-gray-400",children:"Brak danych"})})]})]})]}),d==="automod"&&t&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(i,{className:"card p-6",children:[e.jsx("h2",{className:"section-title mb-4",children:s("adminStats.violationsByType")||"Naruszenia wg typu"}),e.jsx("div",{className:"h-72",children:((N=t.violationsByType)==null?void 0:N.length)>0?e.jsx(m,{width:"100%",height:"100%",children:e.jsxs(ae,{children:[e.jsx(se,{data:t.violationsByType.map(a=>({name:a.type,value:a.count})),cx:"50%",cy:"50%",innerRadius:50,outerRadius:90,paddingAngle:3,dataKey:"value",label:({name:a,percent:r})=>`${a} ${(r*100).toFixed(0)}%`,children:t.violationsByType.map((a,r)=>e.jsx(te,{fill:P[r%P.length]},`cell-${r}`))}),e.jsx(x,{contentStyle:y}),e.jsx(re,{})]})}):e.jsx("div",{className:"h-full flex items-center justify-center text-gray-400",children:"Brak naruszen"})})]}),e.jsxs(i,{className:"card p-6",children:[e.jsx("h2",{className:"section-title mb-4",children:s("adminStats.recentViolations")||"Ostatnie naruszenia"}),e.jsx("div",{className:"overflow-x-auto max-h-72 overflow-y-auto",children:((v=t.recentViolations)==null?void 0:v.length)>0?e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200 dark:border-dark-700",children:[e.jsx("th",{className:"text-left py-2 text-xs text-gray-500 dark:text-gray-400",children:s("adminStats.type")||"Typ"}),e.jsx("th",{className:"text-left py-2 text-xs text-gray-500 dark:text-gray-400",children:s("adminStats.action")||"Akcja"}),e.jsx("th",{className:"text-left py-2 text-xs text-gray-500 dark:text-gray-400",children:s("adminStats.guild")||"Serwer"}),e.jsx("th",{className:"text-left py-2 text-xs text-gray-500 dark:text-gray-400",children:s("adminStats.date")||"Data"})]})}),e.jsx("tbody",{children:t.recentViolations.slice(0,15).map(a=>e.jsxs("tr",{className:"border-b border-gray-100 dark:border-dark-700/50",children:[e.jsx("td",{className:"py-2",children:e.jsx("span",{className:"text-xs font-medium text-red-600 dark:text-red-400",children:a.violationType})}),e.jsx("td",{className:"py-2",children:e.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-300",children:a.actionTaken})}),e.jsx("td",{className:"py-2",children:e.jsx("span",{className:"text-xs font-mono text-gray-500 dark:text-gray-400",children:a.guildId})}),e.jsx("td",{className:"py-2 text-xs text-gray-400",children:new Date(a.createdAt).toLocaleDateString("pl-PL")})]},a.id))})]}):e.jsx("div",{className:"flex items-center justify-center py-8 text-gray-400",children:"Brak naruszen"})})]})]})}),d==="moderation"&&t&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(l,{title:s("adminStats.warningsIssued")||"Ostrzezenia",value:t.warningsCount||0,icon:I,color:"yellow",subtitle:`${t.activeWarnings||0} ${s("adminStats.active")||"aktywnych"}`}),e.jsx(l,{title:s("adminStats.mutesIssued")||"Wyciszenia",value:t.mutesCount||0,icon:Q,color:"red",subtitle:`${t.activeMutes||0} ${s("adminStats.active")||"aktywnych"}`}),e.jsx(l,{title:s("adminStats.totalActions")||"Razem akcji",value:((S=t.actionsByType)==null?void 0:S.reduce((a,r)=>a+r.count,0))||0,icon:z,color:"blue"}),e.jsx(l,{title:s("adminStats.activeModerators")||"Aktywni moderatorzy",value:((w=t.topModerators)==null?void 0:w.length)||0,icon:H,color:"purple"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(i,{className:"card p-6",children:[e.jsx("h2",{className:"section-title mb-4",children:s("adminStats.actionsByType")||"Akcje wg typu"}),e.jsx("div",{className:"h-64",children:((C=t.actionsByType)==null?void 0:C.length)>0?e.jsx(m,{width:"100%",height:"100%",children:e.jsxs(ie,{data:t.actionsByType,children:[e.jsx(D,{strokeDasharray:"3 3",stroke:"#374151",opacity:.3}),e.jsx(F,{dataKey:"type",stroke:"#9ca3af",tick:{fontSize:10},angle:-20,textAnchor:"end",height:60}),e.jsx(M,{stroke:"#9ca3af"}),e.jsx(x,{contentStyle:y}),e.jsx(de,{dataKey:"count",fill:"#f59e0b",radius:[4,4,0,0],name:s("adminStats.count")||"Ilosc"})]})}):e.jsx("div",{className:"h-full flex items-center justify-center text-gray-400",children:"Brak danych"})})]}),e.jsxs(i,{className:"card p-6",children:[e.jsx("h2",{className:"section-title mb-4",children:s("adminStats.topModerators")||"Top moderatorzy"}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:((A=t.topModerators)==null?void 0:A.length)>0?t.topModerators.map((a,r)=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 dark:bg-dark-700/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-6 h-6 rounded-full bg-amber-100 dark:bg-amber-900/30 text-amber-600 dark:text-amber-400 text-xs font-bold flex items-center justify-center",children:r+1}),e.jsx("span",{className:"text-sm font-mono text-gray-700 dark:text-gray-200",children:a.moderatorId})]}),e.jsxs("span",{className:"text-sm font-semibold text-gray-600 dark:text-gray-300",children:[a.count," ",s("adminStats.actions")||"akcji"]})]},a.moderatorId)):e.jsx("div",{className:"text-center py-8 text-gray-400",children:"Brak danych"})})]})]}),e.jsxs(i,{className:"card p-6",children:[e.jsx("h2",{className:"section-title mb-4",children:s("adminStats.perServer")||"Moderacja na serwer"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:((T=t.perServer)==null?void 0:T.length)>0?t.perServer.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-dark-700/50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-mono text-gray-600 dark:text-gray-300 truncate",children:a.guildId}),e.jsx("span",{className:"text-sm font-bold text-gray-700 dark:text-gray-200 ml-2",children:a.count})]},a.guildId)):e.jsx("div",{className:"col-span-full text-center py-4 text-gray-400",children:"Brak danych"})})]})]})]})]})}export{pe as default};
