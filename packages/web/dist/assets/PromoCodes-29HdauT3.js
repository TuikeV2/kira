import{j as e}from"./vendor-motion-DD2yjgze.js";import{r as d}from"./vendor-react-Chdf233T.js";import{u as A,b as U,G as P,bm as o,as as F,B as S,C as V,l as D,D as E,ap as I,E as L}from"./index-Cwht9-s6.js";import{P as $}from"./PageHeader-dyIY6vfZ.js";import"./vendor-utils-BpAiQRgT.js";import"./vendor-icons-DwoABqcb.js";function z(){const{user:x}=A(),{t:s}=U(),p=P(),[g,b]=d.useState([]),[k,j]=d.useState(!0),[C,u]=d.useState(!1),[c,m]=d.useState(null),[a,r]=d.useState({code:"",discountType:"percentage",discountValue:10,maxUses:"",expiresAt:""});d.useEffect(()=>{i()},[]);const i=async()=>{try{const t=await o.getAll();b(t.data.data)}catch{}finally{j(!1)}},h=()=>{r({code:"",discountType:"percentage",discountValue:10,maxUses:"",expiresAt:""}),m(null),u(!1)},f=async t=>{var l,y;t.preventDefault();try{const n={code:a.code,discountType:a.discountType,discountValue:parseFloat(a.discountValue),maxUses:a.maxUses?parseInt(a.maxUses):null,expiresAt:a.expiresAt||null};c?await o.update(c,n):await o.create(n),h(),i()}catch(n){p.error(((y=(l=n.response)==null?void 0:l.data)==null?void 0:y.message)||s("promoCodes.saveError"))}},v=t=>{r({code:t.code,discountType:t.discountType,discountValue:t.discountValue,maxUses:t.maxUses||"",expiresAt:t.expiresAt?t.expiresAt.split("T")[0]:""}),m(t.id),u(!0)},N=async t=>{if(confirm(s("promoCodes.deleteConfirm")))try{await o.delete(t),i()}catch{p.error(s("promoCodes.deleteError"))}},w=async t=>{try{await o.update(t.id,{isActive:!t.isActive}),i()}catch{}},T=t=>{navigator.clipboard.writeText(t),p.success(s("promoCodes.codeCopied"))};return k?e.jsx("div",{className:"text-center py-8",children:s("promoCodes.loading")}):(x==null?void 0:x.role)!=="ADMIN"?e.jsx("div",{className:"text-center py-12 text-gray-500",children:s("promoCodes.accessDenied")}):e.jsxs("div",{children:[e.jsx($,{title:s("promoCodes.title"),icon:F,iconColor:"text-green-500",actions:e.jsxs("button",{onClick:()=>u(!0),className:"btn-primary flex items-center gap-2",children:[e.jsx(S,{}),e.jsx("span",{children:s("promoCodes.newCode")})]})}),C&&e.jsxs("div",{className:"card p-6 mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-900 dark:text-white",children:s(c?"promoCodes.editCode":"promoCodes.createCode")}),e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 dark:text-gray-300 mb-2",children:s("promoCodes.code")}),e.jsx("input",{type:"text",value:a.code,onChange:t=>r({...a,code:t.target.value.toUpperCase()}),placeholder:s("promoCodes.codePlaceholder"),className:"w-full px-4 py-2 border border-gray-300 dark:border-dark-600 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white dark:bg-dark-700 text-gray-900 dark:text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 dark:text-gray-300 mb-2",children:s("promoCodes.discountType")}),e.jsxs("select",{value:a.discountType,onChange:t=>r({...a,discountType:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-dark-600 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white dark:bg-dark-700 text-gray-900 dark:text-white",children:[e.jsx("option",{value:"percentage",children:s("promoCodes.percentage")}),e.jsx("option",{value:"fixed",children:s("promoCodes.fixed")})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-gray-700 dark:text-gray-300 mb-2",children:[s("promoCodes.value")," ",a.discountType==="percentage"?"(%)":"(PLN)"]}),e.jsx("input",{type:"number",min:"0",max:a.discountType==="percentage"?"100":"9999",step:a.discountType==="percentage"?"1":"0.01",value:a.discountValue,onChange:t=>r({...a,discountValue:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-dark-600 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white dark:bg-dark-700 text-gray-900 dark:text-white",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 dark:text-gray-300 mb-2",children:s("promoCodes.maxUses")}),e.jsx("input",{type:"number",min:"1",value:a.maxUses,onChange:t=>r({...a,maxUses:t.target.value}),placeholder:s("promoCodes.maxUsesPlaceholder"),className:"w-full px-4 py-2 border border-gray-300 dark:border-dark-600 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white dark:bg-dark-700 text-gray-900 dark:text-white"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 dark:text-gray-300 mb-2",children:s("promoCodes.expires")}),e.jsx("input",{type:"date",value:a.expiresAt,onChange:t=>r({...a,expiresAt:t.target.value}),className:"w-full px-4 py-2 border border-gray-300 dark:border-dark-600 rounded-lg focus:ring-2 focus:ring-blue-500 bg-white dark:bg-dark-700 text-gray-900 dark:text-white"})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{type:"submit",className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg",children:s(c?"promoCodes.save":"promoCodes.create")}),e.jsx("button",{type:"button",onClick:h,className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg",children:s("promoCodes.cancel")})]})]})]}),e.jsx("div",{className:"card overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-dark-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-dark-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:s("promoCodes.code")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:s("promoCodes.discount")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:s("promoCodes.uses")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:s("promoCodes.isActive")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:s("promoCodes.expires")}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase",children:s("promoCodes.actions")})]})}),e.jsx("tbody",{className:"bg-white dark:bg-dark-800 divide-y divide-gray-200 dark:divide-dark-700",children:g.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"px-6 py-8 text-center text-gray-500 dark:text-gray-400",children:s("promoCodes.noPromoCodes")})}):g.map(t=>e.jsxs("tr",{children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-mono flex items-center gap-2 text-gray-900 dark:text-gray-100",children:[t.code,e.jsx("button",{onClick:()=>T(t.code),className:"text-gray-400 hover:text-blue-500 dark:hover:text-blue-400",children:e.jsx(V,{})})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-semibold ${t.discountType==="percentage"?"bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300":"bg-blue-100 dark:bg-blue-900/30 text-blue-800 dark:text-blue-300"}`,children:t.discountType==="percentage"?`${t.discountValue}%`:`${t.discountValue} PLN`})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:[t.usedCount," / ",t.maxUses||"âˆž"]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("button",{onClick:()=>w(t),children:t.isActive?e.jsx(D,{className:"text-green-600 dark:text-green-400 hover:text-green-800"}):e.jsx(E,{className:"text-red-600 dark:text-red-400 hover:text-red-800"})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-gray-100",children:t.expiresAt?new Date(t.expiresAt).toLocaleDateString():s("promoCodes.never")}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right space-x-2",children:[e.jsx("button",{onClick:()=>v(t),className:"text-blue-600 hover:text-blue-800 p-2",title:s("promoCodes.editTooltip"),children:e.jsx(I,{})}),e.jsx("button",{onClick:()=>N(t.id),className:"text-red-600 hover:text-red-800 p-2",title:s("promoCodes.deleteTooltip"),children:e.jsx(L,{})})]})]},t.id))})]})})]})}export{z as default};
